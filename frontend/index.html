<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pandora's Box - Real-time Trading Signal Dashboard">
    <title>Pandora's Box</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0a0e27">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-section">
                <h1 class="logo">üì¶ PANDORA'S BOX</h1>
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Connecting...</span>
                </div>
            </div>
            <div class="header-controls">
                <select id="timeframeSelector" class="timeframe-selector">
                    <option value="DAILY">Daily</option>
                    <option value="WEEKLY" selected>Weekly</option>
                    <option value="MONTHLY">Monthly</option>
                </select>
                <button class="refresh-btn" id="refreshBtn">‚Üª Refresh</button>
            </div>
        </header>

        <!-- Bias Indicators -->
        <section class="bias-section">
            <div class="bias-card" id="dailyBias">
                <h3>Daily Bias</h3>
                <div class="bias-display">
                    <div class="bias-level" id="dailyLevel">NEUTRAL</div>
                    <div class="bias-details" id="dailyDetails">Loading...</div>
                </div>
            </div>
            <div class="bias-card" id="weeklyBias">
                <h3>Weekly Bias</h3>
                <div class="bias-display">
                    <div class="bias-level" id="weeklyLevel">NEUTRAL</div>
                    <div class="bias-details" id="weeklyDetails">Loading...</div>
                </div>
            </div>
            <div class="bias-card" id="monthlyBias">
                <h3>Monthly Bias (Savita)</h3>
                <div class="bias-display">
                    <div class="bias-level" id="monthlyLevel">NEUTRAL</div>
                    <div class="bias-details" id="monthlyDetails">Loading...</div>
                </div>
            </div>
            <div class="bias-card" id="dollarSmileBias">
                <h3>üíµ Dollar Smile (Macro)</h3>
                <div class="bias-display">
                    <div class="bias-level" id="dollarSmileLevel">NEUTRAL</div>
                    <div class="bias-details" id="dollarSmileDetails">Awaiting webhook data...</div>
                </div>
                <div class="dollar-smile-data" id="dollarSmileData">
                    <small>DXY: -- | VIX: --</small>
                </div>
            </div>
        </section>

        <!-- Main Content: Chart + Trade Recommendations -->
        <section class="main-content">
            <!-- Chart Area (2/3 width) -->
            <div class="chart-area">
                <div class="chart-tabs">
                    <button class="chart-tab active" data-symbol="SPY">SPY</button>
                    <button class="chart-tab" data-symbol="VIX">VIX</button>
                    <button class="chart-tab" data-symbol="BTCUSD">BTC</button>
                </div>
                <div class="chart-container" id="chartContainer">
                    <!-- TradingView Widget -->
                    <div id="tradingview-widget"></div>
                </div>
            </div>

            <!-- Trade Recommendations (1/3 width) -->
            <div class="trades-panel">
                <div class="trades-header">
                    <h2>TRADE IDEAS</h2>
                    <div class="asset-toggle">
                        <button class="toggle-btn active" data-asset="equity">Equities</button>
                        <button class="toggle-btn" data-asset="crypto">Crypto</button>
                    </div>
                </div>
                <div class="signals-container" id="tradeSignals">
                    <!-- Signals will be populated by JavaScript -->
                    <p class="empty-state">No signals available</p>
                </div>
            </div>
        </section>

        <!-- Watchlist & Single Ticker Scanner -->
        <section class="watchlist-section">
            <div class="watchlist-container">
                <div class="watchlist-header">
                    <h2>üìã MY WATCHLIST</h2>
                    <span class="watchlist-count" id="watchlistCount">0</span>
                </div>
                <div class="watchlist-controls">
                    <div class="watchlist-input-group">
                        <input type="text" id="addTickerInput" class="watchlist-input" placeholder="Add ticker (e.g. AAPL)">
                        <button class="watchlist-btn add" id="addTickerBtn">+ Add</button>
                    </div>
                </div>
                <div class="watchlist-tickers" id="watchlistTickers">
                    <p class="empty-state">Loading watchlist...</p>
                </div>
                <div class="watchlist-actions">
                    <button class="watchlist-btn secondary" id="resetWatchlistBtn">Reset to Defaults</button>
                </div>
            </div>
            
            <div class="ticker-analyzer">
                <div class="analyzer-header">
                    <h2>üî¨ SINGLE TICKER ANALYZER</h2>
                </div>
                <div class="analyzer-controls">
                    <div class="analyzer-input-group">
                        <input type="text" id="analyzeTickerInput" class="analyzer-input" placeholder="Enter ticker to analyze">
                        <button class="analyzer-btn" id="analyzeTickerBtn">Analyze</button>
                    </div>
                </div>
                <div class="analyzer-results" id="analyzerResults">
                    <p class="empty-state">Enter a ticker to see Hunter criteria breakdown</p>
                </div>
            </div>
        </section>

        <!-- CTA Scanner Results (Equity Swing Trading) -->
        <section class="cta-section">
            <div class="cta-header">
                <h2>üéØ CTA SCANNER (Equity Swing)</h2>
                <div class="cta-controls">
                    <button class="cta-btn" id="runCtaScanBtn">Run Scan</button>
                    <span class="scan-status" id="ctaScanStatus">Ready</span>
                </div>
            </div>
            <p class="cta-info">CTA Replication Strategy ‚Ä¢ 20/50/120 SMAs ‚Ä¢ Watchlist + S&P 500</p>
            
            <!-- CTA Zone Dashboard -->
            <div class="cta-zones-dashboard">
                <h3>üìä CTA Zone Dashboard</h3>
                <div class="cta-zone-cards" id="ctaZoneCards">
                    <div class="cta-zone-card" data-ticker="SPY">
                        <span class="zone-ticker">SPY</span>
                        <span class="zone-status loading">Loading...</span>
                    </div>
                </div>
            </div>
            
            <!-- CTA Signal Results -->
            <div class="cta-results">
                <div class="cta-column golden-column">
                    <div class="cta-column-header">
                        <h3>üåü GOLDEN TOUCH</h3>
                        <span class="signal-count" id="goldenCount">0</span>
                    </div>
                    <div class="cta-signals" id="goldenSignals">
                        <p class="empty-state">Rare: 120 SMA first touch</p>
                    </div>
                </div>
                <div class="cta-column twoclose-column">
                    <div class="cta-column-header">
                        <h3>‚úÖ TWO-CLOSE + VOL</h3>
                        <span class="signal-count" id="twoCloseCount">0</span>
                    </div>
                    <div class="cta-signals" id="twoCloseSignals">
                        <p class="empty-state">No confirmed breakouts</p>
                    </div>
                </div>
                <div class="cta-column pullback-column">
                    <div class="cta-column-header">
                        <h3>‚Ü©Ô∏è PULLBACK ENTRY</h3>
                        <span class="signal-count" id="pullbackCount">0</span>
                    </div>
                    <div class="cta-signals" id="pullbackSignals">
                        <p class="empty-state">No pullbacks to 20 SMA</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- BTC Bottom Signals Checklist -->
        <section class="btc-signals-section">
            <div class="btc-signals-header">
                <h2>‚Çø BTC BOTTOM SIGNALS</h2>
                <div class="btc-signals-controls">
                    <button class="btc-btn" id="refreshBtcSignalsBtn">‚Üª Refresh</button>
                    <button class="btc-btn secondary" id="resetBtcSignalsBtn">Reset All</button>
                </div>
            </div>
            <p class="btc-info">"We identify structural exhaustion of sellers and reset of leverage"</p>
            
            <!-- Confluence Summary -->
            <div class="btc-confluence-summary" id="btcConfluenceSummary">
                <div class="confluence-meter">
                    <span class="confluence-count">0/9</span>
                    <span class="confluence-label">Signals Firing</span>
                </div>
                <div class="confluence-verdict">Checking signals...</div>
            </div>
            
            <!-- Signal Checklist -->
            <div class="btc-signals-grid" id="btcSignalsGrid">
                <p class="empty-state">Loading signals...</p>
            </div>
            
            <!-- BTC Session Windows -->
            <div class="btc-sessions">
                <h3>‚è∞ BTC Trading Sessions (ET)</h3>
                <div class="btc-session-current" id="btcSessionCurrent">
                    <span class="session-status">Checking...</span>
                </div>
                <div class="btc-session-list" id="btcSessionList">
                    <!-- Sessions will be populated by JS -->
                </div>
            </div>
        </section>

        <!-- Options Flow (Unusual Whales) -->
        <section class="flow-section">
            <div class="flow-header">
                <h2>üêã OPTIONS FLOW</h2>
                <div class="flow-controls">
                    <button class="flow-btn" id="refreshFlowBtn">‚Üª Refresh</button>
                    <span class="flow-status" id="flowStatus">Not Connected</span>
                </div>
            </div>
            <p class="flow-info">Unusual Whales integration ‚Ä¢ Manual entry available ‚Ä¢ Auto-confirms CTA signals</p>
            
            <!-- Hot Tickers -->
            <div class="flow-hot-tickers">
                <h3>üî• Hot Flow</h3>
                <div class="flow-hot-list" id="flowHotList">
                    <p class="empty-state">No flow data yet</p>
                </div>
            </div>
            
            <!-- Recent Alerts -->
            <div class="flow-recent">
                <h3>üìä Recent Alerts</h3>
                <div class="flow-alerts-list" id="flowAlertsList">
                    <p class="empty-state">No recent alerts</p>
                </div>
            </div>
            
            <!-- Manual Entry Button -->
            <div class="flow-manual-entry">
                <button class="flow-btn add full-width" id="openFlowModalBtn">‚ûï Add Flow Observation</button>
            </div>
        </section>

        <!-- Flow Entry Modal -->
        <div class="modal-overlay" id="flowModalOverlay">
            <div class="flow-modal">
                <div class="flow-modal-header">
                    <h2>üêã Add Flow Observation</h2>
                    <button class="modal-close" id="closeFlowModalBtn">‚úï</button>
                </div>
                
                <!-- Notability Score -->
                <div class="flow-score-display" id="flowScoreDisplay">
                    <div class="flow-score-circle" id="flowScoreCircle">
                        <span class="flow-score-value" id="flowScoreValue">0</span>
                    </div>
                    <div class="flow-score-label" id="flowScoreLabel">Fill in details below</div>
                </div>
                
                <div class="flow-modal-body">
                    <!-- Ticker -->
                    <div class="flow-field">
                        <label>Ticker Symbol *</label>
                        <input type="text" id="modalFlowTicker" placeholder="e.g. NVDA" class="flow-modal-input">
                    </div>
                    
                    <!-- Direction -->
                    <div class="flow-field">
                        <label>Direction *</label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="sentiment" data-value="BULLISH">üü¢ Calls (Bullish)</button>
                            <button class="flow-option-btn" data-field="sentiment" data-value="BEARISH">üî¥ Puts (Bearish)</button>
                        </div>
                    </div>
                    
                    <!-- Flow Type -->
                    <div class="flow-field">
                        <label>Flow Type * <span class="field-hint">(Sweeps = most aggressive)</span></label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="type" data-value="SWEEP">üî• Sweep</button>
                            <button class="flow-option-btn" data-field="type" data-value="BLOCK">üì¶ Block</button>
                            <button class="flow-option-btn" data-field="type" data-value="UNUSUAL_VOLUME">üìä Unusual Vol</button>
                            <button class="flow-option-btn" data-field="type" data-value="DARK_POOL">üåë Dark Pool</button>
                        </div>
                    </div>
                    
                    <!-- Premium -->
                    <div class="flow-field">
                        <label>Premium Size * <span class="field-hint">(Total $ of the trade)</span></label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="premium" data-value="25000">$25K-$50K</button>
                            <button class="flow-option-btn" data-field="premium" data-value="75000">$50K-$100K</button>
                            <button class="flow-option-btn" data-field="premium" data-value="150000">$100K-$250K</button>
                            <button class="flow-option-btn" data-field="premium" data-value="500000">$250K+</button>
                        </div>
                    </div>
                    
                    <!-- Expiry -->
                    <div class="flow-field">
                        <label>Expiry Timeframe <span class="field-hint">(How soon do contracts expire?)</span></label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="expiry" data-value="0dte">0DTE</button>
                            <button class="flow-option-btn" data-field="expiry" data-value="week">This Week</button>
                            <button class="flow-option-btn" data-field="expiry" data-value="2-4weeks">2-4 Weeks</button>
                            <button class="flow-option-btn" data-field="expiry" data-value="monthly">Monthly+</button>
                            <button class="flow-option-btn" data-field="expiry" data-value="leaps">LEAPS (6mo+)</button>
                        </div>
                    </div>
                    
                    <!-- Volume vs OI -->
                    <div class="flow-field">
                        <label>Volume vs Open Interest <span class="field-hint">(Is volume unusually high?)</span></label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="voloi" data-value="low">Vol < OI</button>
                            <button class="flow-option-btn" data-field="voloi" data-value="normal">Vol ‚âà OI</button>
                            <button class="flow-option-btn" data-field="voloi" data-value="high">Vol > OI</button>
                            <button class="flow-option-btn" data-field="voloi" data-value="extreme">Vol >> OI (5x+)</button>
                        </div>
                    </div>
                    
                    <!-- Repeat Activity -->
                    <div class="flow-field">
                        <label>Repeat Activity? <span class="field-hint">(Same strike getting hit multiple times?)</span></label>
                        <div class="flow-btn-group">
                            <button class="flow-option-btn" data-field="repeat" data-value="no">Single Trade</button>
                            <button class="flow-option-btn" data-field="repeat" data-value="yes">Multiple Hits</button>
                        </div>
                    </div>
                    
                    <!-- Notes -->
                    <div class="flow-field">
                        <label>Notes (optional)</label>
                        <input type="text" id="modalFlowNotes" placeholder="e.g. Before earnings, unusual timing..." class="flow-modal-input">
                    </div>
                </div>
                
                <div class="flow-modal-footer">
                    <div class="flow-verdict" id="flowVerdict">
                        <!-- Verdict will appear here -->
                    </div>
                    <button class="flow-btn cancel" id="cancelFlowBtn">Cancel</button>
                    <button class="flow-btn add" id="submitFlowBtn" disabled>Add Flow</button>
                </div>
            </div>
        </section>

        <!-- Strategy Controls -->
        <section class="strategies-section">
            <div class="strategies-header">
                <h2>‚öôÔ∏è STRATEGY CONTROLS</h2>
                <div class="strategies-actions">
                    <button class="strategy-btn-small enable-all" id="enableAllBtn">Enable All</button>
                    <button class="strategy-btn-small disable-all" id="disableAllBtn">Disable All</button>
                </div>
            </div>
            <div class="strategies-grid" id="strategiesGrid">
                <!-- Strategies will be populated by JavaScript -->
                <p class="empty-state">Loading strategies...</p>
            </div>
        </section>

        <!-- Open Positions -->
        <section class="positions-section">
            <h2>Open Positions</h2>
            <div class="positions-container" id="openPositions">
                <p class="empty-state">No open positions</p>
            </div>
        </section>
    </div>

    <!-- TradingView Widget Script -->
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script src="app.js?v=5"></script>
</body>
</html>
